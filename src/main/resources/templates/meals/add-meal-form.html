<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Main Page</title>
    <link rel="stylesheet" href="/meals/styles.css">
    <link rel="stylesheet" href="/meals/components/buttons.css">
    <link href="https://fonts.cdnfonts.com/css/spicy-rice" rel="stylesheet">
    <link href="https://fonts.cdnfonts.com/css/source-sans-pro" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

</head>
<body>
<div class="center-container">
    <div class="square-div">

        <div class="top-row-div">
            <a th:href="@{/meals/list}" class="button-main btn-back"><   Back to planner</a>
            <p class="top-meal-planner">Meal Planner</p>
            <a href="/meals/list" class="button-right">Log out</a>
        </div>


        <div>
            <div>
                <p class="fancy-text">New Meal</p>
            </div>
            <form action="#" th:action="@{/meals/save}" th:object="${meal}" method="POST">
                <!-- Meal fields -->
                <div class="middle-row-div">
                    <input type="hidden" th:field="*{id}">
                    <input type="text" th:field="*{mealName}" class="button-submit button-submit1" placeholder="Meal name" oninput="this.value = this.value.replace(/[^A-Za-z0-9\s]/g, '' , required)">
                    <input type="number" th:field="*{makingTime}" class="button-submit button-submit2" placeholder="Making time" min="1" max="9999" oninput="if(this.value.length > 4) this.value = this.value.slice(0, 4);">
                    <input type="number" th:field="*{portions}" class="button-submit button-submit3" placeholder="Portions" min="1" max="9999" oninput="if(this.value.length > 4) this.value = this.value.slice(0, 4);">
                </div>

                <!-- Category selection -->
                <div class="middle-row-down-div">
                    <select id="categorySelect" name="categoryId" class="button-submit button-submit1" required>
                        <option value="">-- Select a Category --</option>
                        <option th:each="cat : ${categories}"
                                th:value="${cat.id}"
                                th:text="${cat.category}"
                                th:selected="${meal.category != null and meal.category.id == cat.id}"></option>
                    </select>
                </div>

                <!-- Ingredients section -->
                <div id="ingredientsList">
                    <!-- This will be populated dynamically with JavaScript -->
                </div>

                <div>
                    <input type="text" id="ingredientName" placeholder="Ingredient name">
                    <input type="number" id="ingredientQuantity" placeholder="Quantity" step="0.01">
                    <select id="ingredientMeasure">
                        <option value="">Select measure</option>
                        <option th:each="measure : ${measures}" th:value="${measure.id}" th:text="${measure.measure}"></option>
                    </select>
                    <button type="button" onclick="addIngredient()">Add Ingredient</button>
                </div>

                <!-- Recipe textarea -->
                <div class="bottom-div-recipe">
                    <textarea th:field="*{mealDescription.description}" class="recipe-textarea" placeholder="Enter your recipe here..." rows="5"></textarea>
                </div>

                <!-- Form buttons -->
                <div class="bottom-div">
                    <button type="submit" class="button-right button-submit">Save</button>
                    <button type="button" class="button-main btn-cancel btn-submit">Cancel</button>
                </div>
            </form>


        </div>



    </div>
</div>
<script th:src="@{/js/meal-form.js}"></script>
</body>
</html>